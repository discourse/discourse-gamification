<DModal
  class="recalculate-scores-form-modal"
  @title={{i18n "gamification.recalculate"}}
>
  <:body>
    {{#if (eq this.status "loading")}}
      <div class="recalculate-modal__status">{{i18n
          "gamification.recalculating"
        }}</div>
    {{else if (eq this.status "complete")}}
      <div class="status">{{d-icon "check"}}
        {{i18n "gamification.completed"}}</div>
    {{else}}
      <form class="form-horizontal">
        <div class="input-group">
          <label>{{i18n "gamification.update_scores_help"}}</label>
          <ComboBox
            @id="update-range"
            @valueProperty="value"
            @content={{this.updateRange}}
            @value={{this.updateRangeValue}}
            @onChange={{action (mut this.updateRangeValue)}}
          />
          {{#if (eq this.updateRangeValue 5)}}
            <div class="input-group">
              <div>{{i18n "gamification.custom_range_from"}}</div>
              <DatePickerPast
                @id="custom-from-date"
                @class="date-input"
                @placeholder="yyyy-mm-dd"
                @value={{recalculateFromDate}}
                @onSelect={{action (mut recalculateFromDate)}}
              />
            </div>
          {{else}}
            <div class="recalculate-modal__date-range">
              {{dateRange}}
            </div>
          {{/if}}
        </div>
      </form>
    {{/if}}
  </:body>
  <:footer>
    <DButton
      @id="apply-section"
      @action={{action "apply"}}
      @class="btn-primary"
      @label="gamification.apply"
      @ariaLabel="gamification.apply"
      @disabled={{applyDisabled}}
    />
    <DButton
      @id="cancel-section"
      @action={{@closeModal}}
      @class="btn-secondary"
      @label={{if
        (eq status "complete")
        "gamification.close"
        "gamification.cancel"
      }}
      @ariaLabel="gamification.cancel"
    />
    <div class="recalculate-modal__footer-text">{{remainingText}}</div>
  </:footer>
</DModal>